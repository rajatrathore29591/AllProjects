<div class="container manage" ng-controller="translationController">
    <div class="sap_tabs">
        <div id="horizontalTab">
            <ul class="resp-tabs-list">
                <a href="#/Main/CreatePromotion/0/Edit">
                    <li class="resp-tab-item" ng-click="onClickTab(1)" ng-class="{active: selectedTab===1}"><span>{{translation.Create}}</span>
                    </li>
                </a>
                <a href="#/Main/Track">
                    <li class="resp-tab-item" ng-click="onClickTab(2)" ng-class="{active: selectedTab===2}"><span>{{translation.Track}}</span>
                    </li>
                </a>
                <a href="#/Main/Manage">
                    <li class="resp-tab-item" ng-click="onClickTab(3)" ng-class="{active: selectedTab===3}"><span>{{translation.Manage}}</span>
                    </li>
                </a>
                <div class="clear"></div>
            </ul>
            <div class="resp-tabs-container padb25" style="min-height: 720px;">
                <div class="row">
                    <div class="col-lg-12">
                        <h3 class="ca stopcur">{{translation.CurrentlyActive}} </h3>
                    </div>
                </div>
                <div ng-show="selectedTab==3" style="background-color: white; overflow: auto; padding-bottom: 40px" class="curactdiv">
                    <div class="curact" ng-repeat="item in promotion">
                        <div ng-if="item.isActive===true">
                            <div class="row">
                                <div class="col-lg-12">
                                    <!-- <p class="promodescr">{{item.descriptionEnglish}}</p>-->
                                    <p class="promodescr" ng-if="item.descriptionEnglish != ''">{{item.descriptionEnglish}}</p>
                                    <p class="promodescr" ng-if="item.descriptionEnglish == ''">{{item.descriptionThai}}</p>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-lg-12">
                                    <label class="promoprice text-center label-warning pull-right"><i class="fa fa-btc"></i>{{item.price}}</label>
                                </div>
                            </div>
                            <div class="row">
                                <div class=" col-lg-12">
                                    <div class="img-thumbnail width100p">
                                        <img class="img-responsive width100p" src="{{config.api}}/Pictures/{{item.logoImg}}" />
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-sm-12">
                                    <div class="row promooptions">
                                        <div class="col-sm-4 col-xs-4 likes " ng-if="item.recommendationCount < 2">
                                            <label class="text-center">{{item.recommendationCount}} {{translation.Like}}</label>
                                        </div>
                                        <div class="col-sm-4 col-xs-4 likes " ng-if="item.recommendationCount > 1">
                                            <label class="text-center">{{item.recommendationCount}} {{translation.Likes}}</label>
                                        </div>
                                        <div class="  col-sm-4 col-xs-2 quantity ">
                                            <span ng-if="item.expiryDate != ''">
                                                <label class="text-center" ng-if="item.expiryDate != '' && item.day > 1"><span class="hidden-xs">{{translation.Endin}} {{item.day}} {{translation.Day}}</label>
                                                <label class="text-center" ng-if="!(item.expiryDate != '' && item.day > 1)"><span class="hidden-xs">{{translation.Endin}} {{item.day}}</label>
                                            </span>
                                            <span ng-if="!(item.expiryDate != '')">
                                                <label class="text-center" ng-if="item.quantity != ''"><span class="hidden-xs">{{translation.Only}} {{item.day}} {{translation.Left}}</label>
                                            </span>
                                        </div>
                                        <div class="col-sm-4  col-xs-6 time">
                                            <label class="text-center"><i class="fa fa-map-marker far5"></i>0 <span class="visible-xs-inline">min</span><span class="hidden-xs">{{translation.minutes}}</span></label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row action">
                                <div class=" col-xs-4  text-left">
                                    <!--<button class="btn btn-warning  ">Edit</button>-->
                                    <a href="#/Main/CreatePromotion/{{item.promotionCodeId}}/Edit" class="btn btn-warning" ng-model="ID">{{translation.Edit}} </a>
                                </div>

                                <div class="pull-right col-xs-4 text-right">
                                    <button ng-click="DeactivatePromotion(item.promotionCodeId)" class="btn btn-warning">{{translation.Cancel}}</button>
                                </div>
                            </div>
                            <hr />
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-lg-12">
                        <h3 class="ca stopprev">{{translation.PreviousPromotions}}</h3>
                    </div>
                </div>
                <div class="MR0Auto" ng-repeat="item in promotion">
                    <span ng-if="item.isActive===false">
                        <div class="row">
                            <div class="col-lg-12">
                                <p class="promodescr">{{item.descriptionEnglish}}</p>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-lg-12">
                                <label class="promoprice text-center label-warning pull-right"><i class="fa fa-btc"></i>{{item.price}}</label>
                            </div>
                        </div>
                        <div class="row">
                            <div class=" col-lg-12">
                                <div class="img-thumbnail width100p ">
                                    <img class="img-responsive center-block width100p" src="{{config.api}}/Pictures/{{item.logoImg}}" />
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-lg-12">
                                <div class="row promooptions">
                                    <div class="col-xs-4 likes ">
                                        <label class="text-center">{{item.recommendationCount}} {{translation.Like}}</label>
                                    </div>
                                    <div class="  col-xs-4 quantity ">
                                        <label class="text-center"><span class="hidden-xs"></label>
                                    </div>
                                    <div class="col-xs-4 time">
                                        <label class="text-center"><i class="fa fa-map-marker far5"></i>0 <span class="visible-xs-inline">min</span><span class="hidden-xs">{{translation.minutes}}</span></label>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row action">
                            <div class=" col-xs-10  text-left">
                                <!--<button class="btn btn-warning  ">Edit</button>-->
                                <a class="btn btn-link" ng-click="pinnedIt(item.promotionCodeId)" ng-if="item.isPinned == false"><i class="fa fa-map-pin far5"></i>{{translation.Pinit}} </a>
                                <a class="btn btn-link" ng-click="pinnedIt(item.promotionCodeId)" ng-if="item.isPinned == true"><i class="fa fa-map-pin far5"></i>{{translation.Pinned}} </a>
                                <a href="#/Main/CreatePromotion/{{item.promotionCodeId}}/Relaunch" class="btn btn-link" ng-model="ID"><i class="fa fa-space-shuttle far5"></i>{{translation.Relaunch}}</a>
                            </div>

                            <div class="pull-right  col-xs-2   text-right">
                                <a ng-click="DeleteOld(item.promotionCodeId)" class="btn btn-link "><i class="fa fa-minus-circle fa-2  fs25"></i></a>
                            </div>
                        </div>
                        <hr />
                    </span>
                </div>
            </div>

        </div>
    </div>

</div>

<div id="loader" ng-show="showLoader">
       <img src="images/loading.gif" /> 
</div>
<div id="static" class="modal fade" tabindex="-1" data-backdrop="static" data-keyboard="false">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true"></button>
                <h4 class="modal-title">Message</h4>
            </div>
            <div class="modal-body">
                <p>
                    <!-- Would you like to continue with some arbitrary task?-->
                    {{Message}}
                </p>
            </div>
            <div class="modal-footer">

                <button type="button" ng-click="redirect()" data-dismiss="modal" class="btn orange">{{translation.Ok}}</button>
            </div>
        </div>
    </div>
</div>
<div id="delete" class="modal fade" tabindex="-1" data-backdrop="static" data-keyboard="false">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true"></button>
                <h4 class="modal-title">Confirmation</h4>
            </div>
            <div class="modal-body">
                <p>
                    <!-- Would you like to continue with some arbitrary task?-->
                    {{Message1}}
                </p>
            </div>
            <div class="modal-footer">

                <button type="button" ng-click="sure()" data-dismiss="modal" class="btn orange">{{translation.Ok}}</button>
                <button type="button" ng-click="cancel()" data-dismiss="modal" class="btn danger">{{translation.Cancel}}</button>
            </div>
        </div>
    </div>
</div>


<script>
    $(document).ready(function () {
        $(window).on('scroll', function () {
            var scrollTop = $(window).scrollTop(),
                elementprevOffset = $('.stopprev').offset().top,
                distanceprev = (elementprevOffset - scrollTop),
                elementcurOffset = $('.stopcur').offset().top,
                distancecur = (elementcurOffset - scrollTop),
                containerleft = $('.container').offset().left,
                containerwidth = $('.container').width(),
                curactoffset = $('.curactdiv').offset().top,
                curactdistance = (curactoffset - scrollTop),
                curactheight = $('.curactdiv').height();
            console.log(curactdistance > (-curactheight));
            if ((distanceprev <= 0) && (scrollTop >= 120) && (curactdistance < (-curactheight))) {
                $('.stopcur').removeClass('stop');
                $('.stopcur').css({ 'left': 'auto', 'width': 'auto' });
                $('.stopprev').addClass('stop');
                $('.stopprev').css({ 'left': containerleft + 15, 'width': containerwidth });
            } else if ((distancecur <= 0) && ((scrollTop >= 120) && (curactdistance > (-curactheight)))) {
                $('.stopprev').removeClass('stop');
                $('.stopprev').css({ 'left': 'auto', 'width': 'auto' });
                $('.stopcur').addClass('stop');
                $('.stopcur').css({ 'left': containerleft + 15, 'width': containerwidth });
            }
            else if (scrollTop <= 119) {
                $('.stopprev').removeClass('stop');
                $('.stopprev').css({ 'left': 'auto', 'width': 'auto' });
                $('.stopcur').removeClass('stop');
                $('.stopcur').css({ 'left': 'auto', 'width': 'auto' });

            }
        })

    })

    function loaderheight() {
        var bodyheight = $('body').height();
        $('#loader').css('height', bodyheight);
    }

    loaderheight();
</script>

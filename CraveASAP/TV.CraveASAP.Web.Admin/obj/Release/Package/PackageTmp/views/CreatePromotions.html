<div class="page-content-wrapper">
    <div style="min-height: 605px" class="page-content">
        <div class="row">

            <div class="col-md-12">

                <div class="portlet box green clearfix">
                    <div class="portlet-title">
                        <div class="caption bold pull-left">
                            <span>Create Promotions &nbsp;<i class="fa fa-refresh fa-spin" ng-if="isbusy"></i></span>
                        </div>
                    </div>

                    <div class="portlet-body form ">

                        <form name="myFrom" type="POST" class="form-horizontal " ng-submit="CreatNew()">
                            <div class="col-lg-12">
                                <div class="form-body row">
                                    <h3 class="title">Category</h3>
                                    <div class="col-md-12 border-top">
                                        <div class="row">
                                            <div class="col-sm-3 ">
                                                <div class="form-group">
                                                    <label class=" col-xs-12 label-custom">Vendor Name</label>
                                                    <div class="col-xs-12">
                                                        <select ng-model="vendor_name" class="form-control" ng-options="item.companyName for item in GetAllVendors" ng-disabled="ddlandbtn">

                                                            <!--  <option ng-repeat="item in GetAllVendors" ng-selected="true" value="{{item.vendorId}}"  >{{item.companyName}}</option>-->

                                                        </select>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-3 ">
                                                <div class="form-group">
                                                    <label class=" col-xs-12 label-custom">Category </label>
                                                    <div class="col-xs-12">

                                                        <select class="form-control" ng-model="categorySelect" ng-change="CategoryClick(categorySelect)" ng-options="item.categoryName for item in category"></select>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-3 ">
                                                  <label class=" col-xs-12 label-custom">Sub-Category</label>
                                                <div class="input-group">
                                                        <select class="form-control subCategoryClear" ng-model="subCategorySelect" ng-options="item.subCategoryName for item in subCategory">
                                                        </select>
                                                        <span class="input-group-addon">
                                                            <span class="glyphicon glyphicon-remove clearSub"></span>
                                                        </span>
                                                </div>
                                            </div>
                                            <div class="col-sm-3 ">
                                                <label class=" col-xs-12 label-custom">Optional-Category</label>
                                                <div class="input-group">
                                                    
                                                        <select class="form-control optCategoryClear" ng-model="optionalCategorySelect" ng-options="item.optCategoryName for item in optionalCategory">
                                                        </select>
                                                        <span class="input-group-addon">
                                                            <span class="glyphicon glyphicon-remove clearOpt"></span>
                                                        </span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <h3 class="title">Promotion Description</h3>
                                    <div class="col-md-12 border-top">
                                        <div class="row">
                                            <div class="col-sm-6">
                                                <div class="form-group">
                                                    <label class=" col-md-12 label-custom">English</label>
                                                    <div class="col-md-12">
                                                        <textarea class=" textarea" ng-model="promotion.descriptionEnglish" maxlength="250"></textarea>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-6">
                                                <div class="form-group">
                                                    <label class=" col-md-12 label-custom">Thai</label>
                                                    <div class="col-md-12">
                                                        <textarea class=" textarea" ng-model="promotion.descriptionThai" maxlength="250"></textarea>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-xs-12 border-top">
                                        <div class="row">
                                            <div class="col-sm-3 col-md-3 col-lg-3 col-xs-12">
                                                <div class="form-group">
                                                    <label class=" col-xs-12 label-custom">Promotion Code</label>
                                                    <div class="col-xs-12">
                                                        <input class="form-control" type="text" ng-model="randomCode" required readonly>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-lg-3 col-md-3 col-sm-3 col-xs-12">
                                                <div class="form-group">
                                                    <label class=" col-xs-12 label-custom">Promotion date</label>
                                                    <!-- <div class="col-md-12">
                                                                <input class="form-control"  type="text" ng-model="createdDate">
                                                            </div>-->
                                                    <div class="col-xs-12">
                                                        <!--<div class="input-group-addon">
                                                            <i class="fa fa-clock-o"></i>
                                                        </div>-->
                                                        <!--<input type="text" class="form-control pull-right ng-pristine ng-valid" name="datetimepkr" ng-model="promotion.createdDate">-->
                                                        <div class='input-group'>
                                                            <input type="text" class="form-control pull-right ng-pristine ng-valid  datepicker startDate" id="createdDate" value="{{createdDate | date: 'yyyy-MM-dd hh:ii:ss'}}" required readonly>
                                                            <span class="input-group-addon">
                                                                <span class="glyphicon glyphicon-remove clear"></span>
                                                                <span class="glyphicon glyphicon-calendar "></span>
                                                            </span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-4 col-lg-3  col-sm-3 col-xs-12 ">
                                                <div class="form-group">
                                                    <label class=" col-xs-12 label-custom">Promotion Image</label>
                                                    <div class="col-xs-12" id="promotionImages">
                                                        <form action="/#" class="dropzone">
                                                            <!-- <input type="file" class="form-control ">-->

                                                            <!-- <input class="form-control" value="test" type="file" ng-model="file" onchange="angular.element(this).scope().uploadFile(this)" name="file" base-sixty-four-input required onload="onLoad" maxsize="500" accept="image/*">-->
                                                            <!--<input type="file" id="files" name="files[]" class="upload" ng-click="remove()" />-->
                                                            <input type="file" name="fileInput" id="file1" onchange="angular.element(this).scope().fileChanged(event)" />

                                                            <!--<div class="col-md-1" id="output" >
                                                            </div>-->

                                                            <script type="text/javascript">
                                                                $(document).ready(function () {


                                                                    if (window.File && window.FileList && window.FileReader) {

                                                                        $("#files").on("change", function (e) {
                                                                            $('.imageThumb').remove();
                                                                            console.log('removed');
                                                                            var files = e.target.files,
                                                                            filesLength = files.length;
                                                                            var f = files[0]
                                                                            var fileReader = new FileReader();
                                                                            fileReader.onload = (function (e) {
                                                                                var file = e.target;
                                                                                $("<img></img>", {
                                                                                    class: "imageThumb",
                                                                                    src: e.target.result,
                                                                                    title: file.name
                                                                                }).appendTo("#output");
                                                                                $('.imageThumb').attr({ width: 100, height: 100 });

                                                                            });
                                                                            fileReader.readAsDataURL(f);
                                                                            /* for (var i = 0; i < 1 ; i++) {
                                                                              
                                                                             }*/
                                                                        });
                                                                    } else { alert("Your browser doesn't support to File API") }
                                                                });
                                                            </script>
                                                            <!--   <table style="display: none" class="table table-bordered table-striped">
                                                                            <tr>
                                                                                <th>filename</th>
                                                                                <th>filetype</th>
                                                                                <th>filesize (<i><small>KB</small></i>)</th>
                                                                                <th>base64</th>
                                                                            </tr>
                                                                            <tr ng-show="file">
                                                                                <td>{{file.filename}}</td>
                                                                                <td>{{file.filetype}}</td>
                                                                                <td>{{file.filesize / 1000}}</td>
                                                                                <td>{{file.base64.substring(0, 30)}}...</td>
                                                                            </tr>
                                                                            <tr>
                                                                                <td colspan="4" ng-show="!file">
                                                                                    <small><i>No file selected.</i></small>
                                                                                </td>
                                                                            </tr>
                                                                        </table>-->
                                                            <!--<input name="file" type="file" multiple ng-model="vendor.promotionImage" />-->
                                                        </form>

                                                    </div>
                                                </div>
                                            </div>

                                            <!--                                            <div class="col-sm-3 ">
                                                <div class="form-group">
                                                    <label class=" col-md-12 label-custom">Promotion Name</label>
                                                    <div class="col-md-12">

                                                        <input class="form-control" type="text" ng-model="promotion.name" required>
                                                        <span ng-show="myForm.name.$error.pattern"><font color="red">Only Alphabet!</font></span>
                                                    </div>
                                                </div>
                                            </div>-->
                                            <div class="col-md-1 col-sm-3 col-xs-12" id="output">
                                                <p id="filename"></p>
                                                <img ng-src="{{path}}{{promotionImage}}" src="{{result}}" height="100px" width="100px" class="img-responsive m-l-0 imageThumb" />

                                            </div>
                                        </div>

                                        <div class="row">
                                            <div class="col-md-4 col-xs-12 ">
                                                <div class="form-group">
                                                    <label class=" col-xs-12 label-custom">Promotion Price</label>
                                                    <div class="col-xs-12">
                                                        <input class="form-control" type="number" ng-model="promotion.price" min="1" required>
                                                        <!-- <span ng-show="myForm.price.$error.pattern"><font color="red">Only No!</font></span>-->
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-4 col-xs-12">
                                                <div class="form-group">
                                                    <label class=" col-xs-12 label-custom">Limit by Quantity</label>
                                                    <div class="col-xs-12">
                                                        <input class="form-control" maxlength="3" type="number" min="0" ng-model="promotion.quantity" />
                                                        <!--<span ng-show="myForm.quantity.$error.pattern"><font color="red">Only No!</font></span>-->
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-12 col-md-1 col-xs-12">
                                                <div class="form-group">
                                                    <label class=" col-xs-12 label-custom-center">OR</label>

                                                </div>
                                            </div>
                                            <div class="col-md-3 col-xs-12 ">
                                                <div class="form-group">
                                                    <label class=" col-xs-10 label-custom">Set End date</label>
                                                    <div class="col-xs-12">
                                                        <div class='input-group'>
                                                            <input type="text" id="expiryDate" value="{{expiryDate | date: 'yyyy-MM-dd hh:ii:ss'}}" class="form-control datepicker endDate" placeholder="From" readonly>
                                                            <!-- <input class="form-control" type="text" ng-model="promotion.expiryDate" id="datepicker">
                                                    </div>-->
                                                            <span class="input-group-addon">
                                                                <span class="glyphicon glyphicon-remove clear1"></span>
                                                                <span class="glyphicon glyphicon-calendar "></span>
                                                            </span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                    </div>
                                </div>

                                <!--<div id='editor' contenteditable>
                                </div>-->
                                <div class="row MT20 PDB50">
                                    <div class="col-md-4 col-xs-12 pull-right">
                                        <!--<button type="button" value="Update" style="margin-left: 10px;" ng-show="ddlandbtn" class="btn btn-danger pull-right" ng-click="Update()">Update</button>-->
                                        <a href="#/Main/ManageActivePromotion" class="btn btn-danger pull-right ml20">Cancel</a>
                                        <button type="submit" value="Submit" class="btn btn-primary pull-right">{{createUpdate}}</button>
                                        &nbsp;
                                    </div>
                                </div>
                                <!-- <div class="col-md-12">
                                                          <img ng-show="hideImg" src="{{path}}{{promotion.promotionImage}}" height="100px" width="400px"/>
                                                    </div>-->
                        </form>
                    </div>
                </div>
            </div>

        </div>
        <!-- END PAGE CONTENT-->
    </div>
</div>
<div id="loader" ng-show="showLoader">
    <div class="page-spinner-bar" ng-spinner-bar="">
        <div class="bounce1"></div>
        <div class="bounce2"></div>
        <div class="bounce3"></div>
    </div>
</div>
<div id="static" class="modal fade" tabindex="-1" data-backdrop="static" data-keyboard="false">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true"></button>
                <h4 class="modal-title">Message</h4>
            </div>
            <div class="modal-body">
                <p>
                    <!-- Would you like to continue with some arbitrary task?-->
                    {{Message}}
                </p>
            </div>
            <div class="modal-footer">

                <button type="button" ng-click="redirect()" data-dismiss="modal" class="btn green">Ok</button>
            </div>
        </div>
    </div>
</div>
<div id="cropm" class="modal fade" tabindex="-1" data-backdrop="static" data-keyboard="false">
    <div class="modal-dialog modallarge">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true"></button>
                <h4 class="modal-title">Image Cropper</h4>
            </div>
            <div class="modal-body">

                <div>
                    <image-crop
                        data-height="350"
                        data-width="350"
                        data-shape="square"
                        data-step="imageCropStep"
                        src="imgSrc"
                        data-result="result"
                        data-result-blob="resultBlob"
                        crop="initCrop"
                        padding="250"
                        max-size="1024"></image-crop>
                </div>

                <div class="center-block cropbtns">
                    <br />
                    <button type="button" ng-click="clear()">Cancel</button>
                    <button type="button" ng-click="initCrop = true;" id="croop">Crop</button>
                </div>
                <div class="hide">
                    <h2>Result</h2>

                    <p>The data-result-blob property is a Blob object, which is necessary in some upload libraries like <a href="https://github.com/nervgh/angular-file-upload" target="_blank">Angular File Upload</a></p>
                    <p>Image using the data uri:</p>
                    <img id="cropimage" ng-src="{{result}}"></img>
                    <p>The Base64 String used in the image above:</p>
                    <textarea class="result-datauri">{{ result }}</textarea>
                    <button type="button" ng-click="clear()">Clear</button>

                </div>

            </div>
            <div class="modal-footer">

                <!--                <button type="button" ng-click="redirect()" data-dismiss="modal" class="btn green">Ok</button>-->
            </div>
        </div>
    </div>
</div>

<!--<div id="cropm" class="modal fade" tabindex="-1" data-backdrop="static" data-keyboard="false">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true"></button>
                <h4 class="modal-title">Message</h4>
            </div>
            <div class="modal-body">

                <div>
                    <image-crop
                        data-height="150"
                        data-width="300"
                        data-shape="square"
                        data-step="imageCropStep"
                        src="imgSrc"
                        data-result="result"
                        data-result-blob="resultBlob"
                        crop="initCrop"
                        padding="250"
                        max-size="1024"></image-crop>
                </div>

                <div class="center-block cropbtns">
                    <br />
                    <button type="button" ng-click="clear()">Cancel</button>
                    <button type="button" ng-click="initCrop = true;" id="croop">Crop</button>
                </div>



            </div>
            <div class="modal-footer">

            </div>
        </div>
    </div>
</div>-->
<script>

    $('#croop').click(function () {
        $('#cropm').modal('hide');


    })
</script>
